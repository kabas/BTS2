"use strict";var btsModule=angular.module("maptestAppApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","uiGmapgoogle-maps"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]);btsModule.config(["uiGmapGoogleMapApiProvider",function(a){a.configure({key:"AIzaSyDartvWxBRwtQW213XfzXBPSuBn-vn-c1E",v:"3.17",libraries:"weather,geometry,visualization"})}]),angular.module("maptestAppApp").controller("MainCtrl",["$scope","$http","$timeout","$window","$log","uiGmapGoogleMapApi",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("maptestAppApp").controller("MapCtrl",["$rootScope","$scope","$http","$timeout","$window","$log","uiGmapGoogleMapApi",function(a,b,c,d,e,f,g){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.map={center:{latitude:36.990282103105066,longitude:-122.06149578094482},markers:[],busInnerStops:[],busOuterStops:[],busStops:[],zoom:e.innerWidth>1024?15:14},a.busCount=0,g.then(function(){j(),k()});var h,i=function(){for(var a=0;a<b.map.markers.length;a++)b.map.markers[a].predictionArray=b.map.markers[a].predictions.split(","),"LOOP"===b.map.markers[a].route&&(b.map.markers[a].route=b.map.markers[a].predictionArray[1]<b.map.markers[a].predictionArray[2]||b.map.markers[a].predictionArray[4]<b.map.markers[a].predictionArray[5]||b.map.markers[a].predictionArray[9]<b.map.markers[a].predictionArray[12]||b.map.markers[a].predictionArray[14]<b.map.markers[a].predictionArray[16]||b.map.markers[a].predictionArray[17]<b.map.markers[a].predictionArray[19]||b.map.markers[a].predictionArray[22]<b.map.markers[a].predictionArray[25]||b.map.markers[a].predictionArray[28]<b.map.markers[a].predictionArray[1]?"INNERLOOP":"OUTERLOOP"),b.map.markers[a].icon="/images/shuttleIcons/"+b.map.markers[a].route+"busS.png";_.each(b.map.markers,function(a){a.closeClick=function(){_.defer(function(){b.$apply()})},a.onClicked=function(){}})},j=function(){var f,g,k=0,l=100,m=5,n=0,o=function(){var a=0;k>=b.oldBusData.markers.length?(b.map.markers=b.busData.markers,i()):(_.each(b.busData.markers,function(c,d){k!==b.oldBusData.markers.length&&b.oldBusData.markers[k].id===c.id&&(b.oldBusData.markers[k].latitude!==c.latitude||b.oldBusData.markers[k].longitude!==c.longitude?(p(d),a=1):k!==b.oldBusData.markers.length&&k++)}),0===a?k++:a=0)},p=function(a){k>=b.oldBusData.markers.length||(n=0,f=(b.busData.markers[a].latitude-b.oldBusData.markers[k].latitude)/l,g=(b.busData.markers[a].longitude-b.oldBusData.markers[k].longitude)/l,0!==f&&0!==g?q():k++)},q=function(){k>=b.oldBusData.markers.length||null===b.map.markers[k]||(b.map.markers[k].latitude+=f,b.map.markers[k].longitude+=g,_.defer(function(){b.$apply()}),n!==l?(n++,setTimeout(q,m)):(k++,o()))};c({method:"GET",url:"http://skynet.soe.ucsc.edu/bts/coord2.json"}).success(function(c){a.busCount=c.count,b.busData?b.oldBusData=b.busData:b.map.markers=c.markers,b.busData=c,b.oldBusData?o():i(),h=d(j,3e3),e.onblur=function(){},e.onfocus=function(){}}).error(function(a,c){return c>=400&&500>c?(b.busData=0,void(b.map.markers=0)):c>=500&&600>c?(b.busData=0,void(b.map.markers=0)):void 0})},k=function(){b.map.busInnerStops=[{id:2,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9967041015625,longitude:-122.063583374023,showWindow:!1,stopName:"Heller & Kerr Hall"},{id:3,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.999210357666,longitude:-122.064338684082,showWindow:!1,stopName:"Heller & Kresge College"},{id:5,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9999313354492,longitude:-122.062049865723,showWindow:!1,stopName:"McLaughlin & Science Hill"},{id:6,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9997062683105,longitude:-122.05834197998,showWindow:!1,stopName:"McLaughlin & College 9 & 10 - Health Center"},{id:10,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9966621398926,longitude:-122.055480957031,showWindow:!1,stopName:"Hagar & Bookstore"},{id:13,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9912567138672,longitude:-122.054962158203,showWindow:!1,stopName:"Hagar & East Remote"},{id:15,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.985523223877,longitude:-122.053588867188,showWindow:!1,stopName:"Hagar & Lower Quarry Rd"},{id:17,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9815368652344,longitude:-122.052131652832,showWindow:!1,stopName:"Coolidge & Hagar"},{id:18,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9787902832031,longitude:-122.057762145996,showWindow:!1,stopName:"High & Western Dr"},{id:20,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9773025512695,longitude:-122.054328918457,showWindow:!1,stopName:"High & Barn Theater"},{id:23,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9826698303223,longitude:-122.062492370605,showWindow:!1,stopName:"Empire Grade & Arboretum"},{id:26,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9905776977539,longitude:-122.066116333008,showWindow:!1,stopName:"Heller & Oakes College"},{id:29,icon:"/images/InnerLoopStop.afd27c1d.png",latitude:36.9927787780762,longitude:-122.064880371094,showWindow:!1,stopName:"Heller & College 8/Porter"}],b.map.busOuterStops=[{id:1,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9992790222168,longitude:-122.064552307129,showWindow:!1,stopName:"Heller & Kresge College"},{id:4,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:37.0000228881836,longitude:-122.062339782715,showWindow:!1,stopName:"McLaughlin & Science Hill"},{id:7,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9999389648438,longitude:-122.058349609375,showWindow:!1,stopName:"McLaughlin & College 9 & 10 - Health Center"},{id:8,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9990234375,longitude:-122.055229187012,showWindow:!1,stopName:"McLaughlin & Crown College"},{id:9,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9974822998047,longitude:-122.055030822754,showWindow:!1,stopName:"Hagar & Bookstore-Stevenson College"},{id:11,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9942474365234,longitude:-122.055511474609,showWindow:!1,stopName:"Hagar & Field House East"},{id:12,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9912986755371,longitude:-122.054656982422,showWindow:!1,stopName:"Hagar & East Remote"},{id:14,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.985912322998,longitude:-122.053520202637,showWindow:!1,stopName:"Hagar & Lower Quarry Rd"},{id:16,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9813537597656,longitude:-122.051971435547,showWindow:!1,stopName:"Coolidge & Hagar"},{id:19,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9776763916016,longitude:-122.053558349609,showWindow:!1,stopName:"Coolidge & Main Entrance"},{id:21,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9786148071289,longitude:-122.05785369873,showWindow:!1,stopName:"High & Western Dr"},{id:22,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9798469543457,longitude:-122.059257507324,showWindow:!1,stopName:"Empire Grade & Tosca Terrace"},{id:24,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.9836616516113,longitude:-122.064964294434,showWindow:!1,stopName:"Empire Grade & Arboretum"},{id:25,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.989917755127,longitude:-122.067230224609,showWindow:!1,stopName:"Heller & Oakes College"},{id:27,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.991828918457,longitude:-122.066833496094,showWindow:!1,stopName:"Heller & Family Student Housing"},{id:28,icon:"/images/OuterLoopStop.72ee3d52.png",latitude:36.992977142334,longitude:-122.065223693848,showWindow:!1,stopName:"Heller & College 8/Porter"}]}}]);